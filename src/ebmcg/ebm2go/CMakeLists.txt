#license
# Code generated by ebmcodegen at https://github.com/on-keyday/rebrgen
project(ebm2go)
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/tool)
add_executable(ebm2go
    "main.cpp"
)
target_precompile_headers(ebm2go PRIVATE
    <format>
    <expected>
    <string>
    <vector>
    <variant>
    <optional>
    <ebm/extended_binary_module.hpp>
    <ebmcodegen/stub/entry.hpp>
    <ebmcodegen/stub/util.hpp>
    <ebmgen/common.hpp>
    <ebmgen/convert/helper.hpp>
    <ebmgen/mapping.hpp>
    <code/code_writer.h>
    <code/loc_writer.h>
    <ebmcodegen/stub/writer_manager.hpp>
    <concepts>
    <strutil/append.h>
)
if(UNIX)
set_target_properties(ebm2go PROPERTIES INSTALL_RPATH "${CMAKE_SOURCE_DIR}/tool")
endif()
target_link_libraries(ebm2go ebm futils ebm_mapping)
install(TARGETS ebm2go DESTINATION tool)
if ("$ENV{BUILD_MODE}" STREQUAL "web")
    target_compile_options(ebm2go PUBLIC "-gsource-map")
    target_link_options(ebm2go PUBLIC "-gsource-map --source-map-base http://localhost:8000/")
    install(FILES "${CMAKE_BINARY_DIR}/tool/ebm2go.wasm" DESTINATION tool)
    install(FILES "${CMAKE_BINARY_DIR}/tool/ebm2go.wasm.map" DESTINATION tool)
endif()
