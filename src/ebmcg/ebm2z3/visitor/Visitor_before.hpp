/*DO NOT EDIT BELOW SECTION MANUALLY*/
/*license*/
// Template generated by ebmcodegen at https://github.com/on-keyday/rebrgen
/*
  Name: Visitor_before
  Available variables:
*/
/*DO NOT EDIT ABOVE SECTION MANUALLY*/

/*here to write the hook*/
std::string solver_name;
std::map<std::uint64_t, int> current_version;
std::string current_ident(auto&& ctx, ebm::StatementRef x) {
    return std::format("{}_{}", ctx.identifier(x), current_version[get_id(x)]);
}

void update_version(ebm::StatementRef x) {
    auto& ver = current_version[get_id(x)];
    ver++;
}

std::vector<CodeWriter> condition_stack;

CodeWriter wrap_condition(std::string old, CodeWriter new_value) {
    if (condition_stack.empty()) {
        return std::move(new_value);
    }
    CodeWriter w;
    for (auto& cond : condition_stack) {
        if (!w.empty()) {
            w = CODE("z3.And(", std::move(w), ", ", cond, ")");
        }
        else {
            w.write(cond);
        }
    }
    return CODE("z3.If(", w, ", ", new_value, ",", old, ")");
}